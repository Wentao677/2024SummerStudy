[
    {
        "node_type": "keyword_extraction",
        "keywords": [
            "Community College District",
            "closure",
            "1989",
            "San Francisco",
            "total amount",
            "city"
        ],
        "status": "success"
    },
    {
        "node_type": "entity_retrieval",
        "similar_columns": {
            "schools": [
                "District",
                "City"
            ]
        },
        "similar_values": {
            "schools": {
                "District": [
                    "Kern Community College"
                ],
                "School": [
                    "Community Middle College"
                ],
                "County": [
                    "San Francisco"
                ],
                "MailCity": [
                    "San Francisco"
                ],
                "City": [
                    "San Francisco"
                ],
                "AdmLName1": [
                    "Sanft"
                ],
                "AdmFName2": [
                    "Francisco"
                ],
                "AdmFName1": [
                    "Francisco"
                ]
            },
            "frpm": {
                "School Name": [
                    "Community Day"
                ],
                "District Type": [
                    "High School District"
                ],
                "County Name": [
                    "San Francisco"
                ]
            },
            "satscores": {
                "cname": [
                    "San Francisco"
                ]
            }
        },
        "status": "success"
    },
    {
        "node_type": "context_retrieval",
        "schema_with_descriptions": {
            "schools": {
                "statustype": {
                    "column_name": "",
                    "column_description": "This field identifies the status of the district.",
                    "value_description": "Definitions of the valid status types are listed below: \u00b7       Active: The district is in operation and providing instructional services. \u00b7       Closed: The district is not in operation and no longer providing instructional services. \u00b7       Merged: The district has combined with another district or districts. \u00b7       Pending: The district has not opened for operation and instructional services yet, but plans to open within the next 9\u201312 months."
                },
                "closeddate": {
                    "column_name": "",
                    "column_description": "The date the school closed.",
                    "value_description": ""
                },
                "district": {
                    "column_name": "",
                    "column_description": "District",
                    "value_description": ""
                },
                "soc": {
                    "column_name": "School Ownership Code",
                    "column_description": "The School Ownership Code is a numeric code used to identify the type of school.",
                    "value_description": "\u2022      08 - Preschool       \u2022       09 \u2013 Special Education Schools (Public) \u2022      11 \u2013 Youth Authority Facilities (CEA) \u2022       13 \u2013 Opportunity Schools \u2022       14 \u2013 Juvenile Court Schools \u2022       15 \u2013 Other County or District Programs \u2022       31 \u2013 State Special Schools \u2022       60 \u2013 Elementary School (Public) \u2022       61 \u2013 Elementary School in 1 School District (Public) \u2022       62 \u2013 Intermediate/Middle Schools (Public) \u2022       63 \u2013 Alternative Schools of Choice \u2022       64 \u2013 Junior High Schools (Public) \u2022       65 \u2013 K-12 Schools (Public) \u2022       66 \u2013 High Schools (Public) \u2022       67 \u2013 High Schools in 1 School District (Public) \u2022       68 \u2013 Continuation High Schools \u2022       69 \u2013 District Community Day Schools \u2022       70 \u2013 Adult Education Centers \u2022       98 \u2013 Regional Occupational Center/Program (ROC/P)"
                },
                "ext": {
                    "column_name": "extension",
                    "column_description": "The phone number extension of the school, district, or administrative authority.",
                    "value_description": "The phone number extension of the school, district, or administrative authority."
                },
                "street": {
                    "column_name": "",
                    "column_description": "Street",
                    "value_description": ""
                },
                "state": {
                    "column_name": "",
                    "column_description": "State",
                    "value_description": ""
                },
                "city": {
                    "column_name": "",
                    "column_description": "City",
                    "value_description": ""
                },
                "admfname2": {
                    "column_name": "",
                    "column_description": "",
                    "value_description": "SAME as 1"
                },
                "gsoffered": {
                    "column_name": "grade span offered",
                    "column_description": "The grade span offered is the lowest grade and the highest grade offered or supported by the school, district, or administrative authority. This field might differ from the grade span served as reported in the most recent certified California Longitudinal Pupil Achievement (CALPADS) Fall 1 data collection.",
                    "value_description": "For example XYZ School might display the following data:  GSoffered = P\u2013Adult  GSserved = K\u201312"
                },
                "mailcity": {
                    "column_name": "mailing city",
                    "column_description": "",
                    "value_description": "The city associated with the mailing address of the school, district, or administrative authority. Note: Many entities have not provided a mailing address city. For your convenience we have filled the unpopulated MailCity cells with City data."
                }
            },
            "satscores": {
                "cds": {
                    "column_name": "",
                    "column_description": "California Department Schools",
                    "value_description": ""
                },
                "dname": {
                    "column_name": "district name",
                    "column_description": "district segment",
                    "value_description": ""
                },
                "sname": {
                    "column_name": "school name",
                    "column_description": "school name",
                    "value_description": ""
                }
            },
            "frpm": {
                "district name": {
                    "column_name": "",
                    "column_description": "District Name",
                    "value_description": ""
                },
                "district type": {
                    "column_name": "",
                    "column_description": "District Type",
                    "value_description": ""
                },
                "school name": {
                    "column_name": "",
                    "column_description": "School Name",
                    "value_description": ""
                },
                "academic year": {
                    "column_name": "",
                    "column_description": "Academic Year",
                    "value_description": ""
                },
                "frpm count (k-12)": {
                    "column_name": "",
                    "column_description": "Free or Reduced Price Meal Count (K-12)",
                    "value_description": "eligible FRPM rate = FRPM / Enrollment"
                },
                "free meal count (k-12)": {
                    "column_name": "",
                    "column_description": "Free Meal Count (K-12)",
                    "value_description": "eligible free rate = Free Meal Count / Enrollment"
                },
                "free meal count (ages 5-17)": {
                    "column_name": "",
                    "column_description": "Free Meal Count (Ages 5-17)",
                    "value_description": "eligible free rate = Free Meal Count / Enrollment"
                }
            }
        },
        "status": "success"
    },
    {
        "node_type": "column_filtering",
        "tentative_schema": {
            "frpm": [
                "School Name",
                "CDSCode"
            ],
            "satscores": [
                "cds"
            ],
            "schools": [
                "District",
                "City",
                "MailCity",
                "ClosedDate",
                "EdOpsCode",
                "CDSCode"
            ]
        },
        "missing_table_status": "success",
        "missing_tables": [],
        "missing_column_status": "missing_column",
        "missing_columns": [
            "'schools'.'school'",
            "'schools'.'doctype'"
        ],
        "correct_columns": {
            "schools": [
                "school",
                "doctype",
                "city",
                "closeddate"
            ]
        },
        "status": "success"
    },
    {
        "node_type": "table_selection",
        "tentative_schema": {
            "frpm": [
                "School Name",
                "CDSCode"
            ],
            "schools": [
                "District",
                "City",
                "MailCity",
                "ClosedDate",
                "EdOpsCode",
                "CDSCode"
            ]
        },
        "chain_of_thought_reasoning": "The question asks for the total amount of Community College District closure in 1989 in the city of San Francisco. The hint points to the 'Community Day' school name, which is present in the 'frpm' table. This suggests that we need to focus on schools with this name. The 'schools' table provides information about the district and city of each school. The 'ClosedDate' column in the 'schools' table indicates when a school was closed. Combining these tables, we can filter schools with the 'Community Day' name, and then filter those that were closed in 1989 and are located in San Francisco.",
        "selected_tables": [
            "frpm",
            "schools"
        ],
        "missing_table_status": "success",
        "missing_tables": [],
        "missing_column_status": "missing_column",
        "missing_columns": [
            "'schools'.'school'",
            "'schools'.'doctype'"
        ],
        "correct_columns": {
            "schools": [
                "school",
                "doctype",
                "city",
                "closeddate"
            ]
        },
        "status": "success"
    },
    {
        "node_type": "column_selection",
        "tentative_schema": {
            "frpm": [
                "CDSCode"
            ],
            "schools": [
                "City",
                "ClosedDate",
                "District"
            ]
        },
        "model_selected_columns": {
            "frpm": [
                "CDSCode"
            ],
            "schools": [
                "City",
                "ClosedDate",
                "District"
            ]
        },
        "chain_of_thought_reasoning": "The question asks for the total amount of Community College District closure in 1989 in the city of San Francisco. To answer this, we need to filter by the city of San Francisco, and then find the total amount of closure in 1989. The hint points to the 'City' column in the 'schools' table and the 'ClosedDate' column in the 'schools' table. We also need to filter by the 'District' column in the 'frpm' table to get the Community College District. Finally, we need to join the 'frpm' and 'schools' tables to get the total amount of closure.",
        "missing_table_status": "success",
        "missing_tables": [],
        "missing_column_status": "missing_column",
        "missing_columns": [
            "'schools'.'school'",
            "'schools'.'doctype'"
        ],
        "correct_columns": {
            "schools": [
                "school",
                "doctype",
                "city",
                "closeddate"
            ]
        },
        "status": "success"
    },
    {
        "node_type": "candidate_generation",
        "SQL": "SELECT COUNT(T1.CDSCode) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'San Francisco' AND T2.District = 'Kern Community College' AND STRFTIME('%Y', T2.ClosedDate) = '1989' ",
        "status": "success"
    },
    {
        "node_type": "revision",
        "chain_of_thought_reasoning": "I started by identifying the relevant columns and tables in the question. The question asks for the total amount of Community College District closure in 1989 in the city of San Francisco. I noticed that the value 'San Francisco' appears in the column County of table schools, MailCity of table schools, County Name of table frpm, and cname of table satscores. I also noticed that the question mentions 'Kern Community College' which is the district name in table schools. I then joined the frpm and schools tables on the CDSCode column and filtered the results to only include rows where the city is 'San Francisco' and the district is 'Kern Community College'. I also filtered the results to only include rows where the ClosedDate is in 1989. Finally, I used the COUNT function to count the number of rows that meet these conditions.",
        "SQL": "SELECT COUNT(T1.CDSCode) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'San Francisco' AND T2.District = 'Kern Community College' AND T2.ClosedDate LIKE '1989-%'",
        "status": "success"
    },
    {
        "node_type": "evaluation",
        "candidate_generation": {
            "exec_res": 0,
            "exec_err": "incorrect answer",
            "Question": "What is the total amount of Community College District closure in 1989 in the city of San Francisco?",
            "Evidence": "",
            "GOLD_SQL": "SELECT COUNT(School) FROM schools WHERE strftime('%Y', ClosedDate) = '1989' AND City = 'San Francisco' AND DOCType = 'Community College District'",
            "PREDICTED_SQL": "SELECT COUNT(T1.CDSCode) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'San Francisco' AND T2.District = 'Kern Community College' AND STRFTIME('%Y', T2.ClosedDate) = '1989' "
        },
        "revision": {
            "exec_res": 0,
            "exec_err": "incorrect answer",
            "Question": "What is the total amount of Community College District closure in 1989 in the city of San Francisco?",
            "Evidence": "",
            "GOLD_SQL": "SELECT COUNT(School) FROM schools WHERE strftime('%Y', ClosedDate) = '1989' AND City = 'San Francisco' AND DOCType = 'Community College District'",
            "PREDICTED_SQL": "SELECT COUNT(T1.CDSCode) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'San Francisco' AND T2.District = 'Kern Community College' AND T2.ClosedDate LIKE '1989-%'"
        },
        "status": "success"
    }
]