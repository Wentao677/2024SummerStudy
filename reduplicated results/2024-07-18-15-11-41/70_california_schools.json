[
    {
        "node_type": "keyword_extraction",
        "keywords": [
            "District Community Day Schools",
            "Alpine",
            "county",
            "active",
            "closed",
            "number of"
        ],
        "status": "success"
    },
    {
        "node_type": "entity_retrieval",
        "similar_columns": {
            "schools": [
                "District",
                "County"
            ]
        },
        "similar_values": {
            "schools": {
                "School": [
                    "Community Day School"
                ],
                "EdOpsName": [
                    "Community Day School"
                ],
                "StreetAbr": [
                    "School St."
                ],
                "MailStrAbr": [
                    "School Rd."
                ],
                "City": [
                    "Alpine"
                ],
                "County": [
                    "Alpine"
                ],
                "MailCity": [
                    "Alpine"
                ],
                "MailStreet": [
                    "555 Alpine Drive"
                ],
                "District": [
                    "Tri-County ROP"
                ],
                "StatusType": [
                    "Closed",
                    "Active"
                ]
            },
            "frpm": {
                "School Name": [
                    "Community Day School III"
                ],
                "Educational Option Type": [
                    "Community Day School"
                ],
                "District Type": [
                    "High School District"
                ],
                "County Name": [
                    "Alpine"
                ]
            }
        },
        "status": "success"
    },
    {
        "node_type": "context_retrieval",
        "schema_with_descriptions": {
            "schools": {
                "soc": {
                    "column_name": "School Ownership Code",
                    "column_description": "The School Ownership Code is a numeric code used to identify the type of school.",
                    "value_description": "\u2022      08 - Preschool       \u2022       09 \u2013 Special Education Schools (Public) \u2022      11 \u2013 Youth Authority Facilities (CEA) \u2022       13 \u2013 Opportunity Schools \u2022       14 \u2013 Juvenile Court Schools \u2022       15 \u2013 Other County or District Programs \u2022       31 \u2013 State Special Schools \u2022       60 \u2013 Elementary School (Public) \u2022       61 \u2013 Elementary School in 1 School District (Public) \u2022       62 \u2013 Intermediate/Middle Schools (Public) \u2022       63 \u2013 Alternative Schools of Choice \u2022       64 \u2013 Junior High Schools (Public) \u2022       65 \u2013 K-12 Schools (Public) \u2022       66 \u2013 High Schools (Public) \u2022       67 \u2013 High Schools in 1 School District (Public) \u2022       68 \u2013 Continuation High Schools \u2022       69 \u2013 District Community Day Schools \u2022       70 \u2013 Adult Education Centers \u2022       98 \u2013 Regional Occupational Center/Program (ROC/P)"
                },
                "closeddate": {
                    "column_name": "",
                    "column_description": "The date the school closed.",
                    "value_description": ""
                },
                "statustype": {
                    "column_name": "",
                    "column_description": "This field identifies the status of the district.",
                    "value_description": "Definitions of the valid status types are listed below: \u00b7       Active: The district is in operation and providing instructional services. \u00b7       Closed: The district is not in operation and no longer providing instructional services. \u00b7       Merged: The district has combined with another district or districts. \u00b7       Pending: The district has not opened for operation and instructional services yet, but plans to open within the next 9\u201312 months."
                },
                "website": {
                    "column_name": "",
                    "column_description": "The website address of the school, district, or administrative authority.",
                    "value_description": "The website address of the school, district, or administrative authority."
                },
                "opendate": {
                    "column_name": "",
                    "column_description": "The date the school opened.",
                    "value_description": ""
                },
                "street": {
                    "column_name": "",
                    "column_description": "Street",
                    "value_description": ""
                },
                "city": {
                    "column_name": "",
                    "column_description": "City",
                    "value_description": ""
                },
                "school": {
                    "column_name": "",
                    "column_description": "School",
                    "value_description": ""
                },
                "state": {
                    "column_name": "",
                    "column_description": "State",
                    "value_description": ""
                },
                "county": {
                    "column_name": "",
                    "column_description": "County name",
                    "value_description": ""
                },
                "phone": {
                    "column_name": "",
                    "column_description": "Phone",
                    "value_description": ""
                },
                "ext": {
                    "column_name": "extension",
                    "column_description": "The phone number extension of the school, district, or administrative authority.",
                    "value_description": "The phone number extension of the school, district, or administrative authority."
                },
                "admfname2": {
                    "column_name": "",
                    "column_description": "",
                    "value_description": "SAME as 1"
                }
            },
            "satscores": {
                "cds": {
                    "column_name": "",
                    "column_description": "California Department Schools",
                    "value_description": ""
                },
                "rtype": {
                    "column_name": "",
                    "column_description": "rtype",
                    "value_description": "unuseful"
                },
                "cname": {
                    "column_name": "county name",
                    "column_description": "county name",
                    "value_description": ""
                },
                "sname": {
                    "column_name": "school name",
                    "column_description": "school name",
                    "value_description": ""
                },
                "numtsttakr": {
                    "column_name": "Number of Test Takers",
                    "column_description": "Number of Test Takers in this school",
                    "value_description": "number of test takers in each school"
                },
                "numge1500": {
                    "column_name": "Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500",
                    "column_description": "Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500",
                    "value_description": "Number of Test Takers Whose Total SAT Scores Are Greater or Equal to 1500    Excellence Rate = NumGE1500 / NumTstTakr"
                }
            },
            "frpm": {
                "county code": {
                    "column_name": "",
                    "column_description": "County Code",
                    "value_description": ""
                },
                "county name": {
                    "column_name": "",
                    "column_description": "County Code",
                    "value_description": ""
                },
                "high grade": {
                    "column_name": "",
                    "column_description": "High Grade",
                    "value_description": ""
                }
            }
        },
        "status": "success"
    },
    {
        "node_type": "column_filtering",
        "tentative_schema": {
            "frpm": [
                "County Code",
                "County Name",
                "District Name",
                "District Type",
                "Educational Option Type",
                "CDSCode"
            ],
            "satscores": [
                "cname",
                "cds"
            ],
            "schools": [
                "CDSCode",
                "StatusType",
                "County",
                "District",
                "School",
                "Zip",
                "MailCity",
                "ClosedDate",
                "DOC",
                "SOC",
                "EdOpsCode",
                "EdOpsName"
            ]
        },
        "missing_table_status": "success",
        "missing_tables": [],
        "missing_column_status": "success",
        "missing_columns": [],
        "correct_columns": {
            "schools": [
                "school",
                "county",
                "soc",
                "statustype"
            ]
        },
        "status": "success"
    },
    {
        "node_type": "table_selection",
        "tentative_schema": {
            "frpm": [
                "County Code",
                "County Name",
                "District Name",
                "District Type",
                "Educational Option Type",
                "CDSCode"
            ],
            "schools": [
                "CDSCode",
                "StatusType",
                "County",
                "District",
                "School",
                "Zip",
                "MailCity",
                "ClosedDate",
                "DOC",
                "SOC",
                "EdOpsCode",
                "EdOpsName"
            ]
        },
        "chain_of_thought_reasoning": "The question asks for the number of active and closed District Community Day Schools in the county of Alpine. The hint suggests focusing on the 'District Type' and 'County' columns. The 'District Type' column in the 'frpm' table and 'schools' table can help identify the type of district, and the 'County' column in the 'schools' table can help identify the county. The 'CDSCode' column in the 'frpm' table and 'schools' table can be used to link the two tables. Therefore, the necessary tables for the SQL query are 'frpm' and 'schools'.",
        "selected_tables": [
            "frpm",
            "schools"
        ],
        "missing_table_status": "success",
        "missing_tables": [],
        "missing_column_status": "success",
        "missing_columns": [],
        "correct_columns": {
            "schools": [
                "school",
                "county",
                "soc",
                "statustype"
            ]
        },
        "status": "success"
    },
    {
        "node_type": "column_selection",
        "tentative_schema": {
            "frpm": [
                "County Code",
                "District Type",
                "Educational Option Type"
            ],
            "schools": [
                "CDSCode",
                "StatusType",
                "County",
                "District",
                "School",
                "SOC"
            ]
        },
        "model_selected_columns": {
            "frpm": [
                "County Code",
                "District Type",
                "Educational Option Type"
            ],
            "schools": [
                "CDSCode",
                "StatusType",
                "County",
                "District",
                "School",
                "SOC"
            ]
        },
        "chain_of_thought_reasoning": "The question asks for active and closed District Community Day Schools in the county of Alpine. We need to filter by County, District Type, and School to get the desired results. We also need to filter by StatusType to get active and closed schools.",
        "missing_table_status": "success",
        "missing_tables": [],
        "missing_column_status": "success",
        "missing_columns": [],
        "correct_columns": {
            "schools": [
                "school",
                "county",
                "soc",
                "statustype"
            ]
        },
        "status": "success"
    },
    {
        "node_type": "candidate_generation",
        "SQL": "SELECT SUM(CASE WHEN T2.StatusType = 'Active' THEN 1 ELSE 0 END) AS num1 , SUM(CASE WHEN T2.StatusType = 'Closed' THEN 1 ELSE 0 END) AS num2 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Alpine' AND T1.`Educational Option Type` = 'Community Day School' AND T1.`District Type` = 'High School District' ",
        "status": "success"
    },
    {
        "node_type": "revision",
        "chain_of_thought_reasoning": "I started by analyzing the question and identifying the key elements: finding active and closed District Community Day Schools in the county of Alpine. I then looked at the database schema and identified the relevant tables and columns. I joined the frpm and schools tables on the CDSCode column, filtered the results to include only schools in the county of Alpine and with the correct Educational Option Type and District Type. Finally, I used the SUM(CASE WHEN ... THEN 1 ELSE 0 END) construct to count the number of active and closed schools.",
        "SQL": "SELECT SUM(CASE WHEN T2.StatusType = 'Active' THEN 1 ELSE 0 END) AS num1 , SUM(CASE WHEN T2.StatusType = 'Closed' THEN 1 ELSE 0 END) AS num2 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Alpine' AND T1.`Educational Option Type` = 'Community Day School' AND T2.`School` = 'Community Day School' AND (T2.StatusType = 'Active' OR T2.StatusType = 'Closed')",
        "status": "success"
    },
    {
        "node_type": "evaluation",
        "candidate_generation": {
            "exec_res": 0,
            "exec_err": "incorrect answer",
            "Question": "How many active and closed District Community Day Schools are there in the county of Alpine?",
            "Evidence": "",
            "GOLD_SQL": "SELECT COUNT(School) FROM schools WHERE (StatusType = 'Closed' OR StatusType = 'Active') AND SOC = 69 AND County = 'Alpine'",
            "PREDICTED_SQL": "SELECT SUM(CASE WHEN T2.StatusType = 'Active' THEN 1 ELSE 0 END) AS num1 , SUM(CASE WHEN T2.StatusType = 'Closed' THEN 1 ELSE 0 END) AS num2 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Alpine' AND T1.`Educational Option Type` = 'Community Day School' AND T1.`District Type` = 'High School District' "
        },
        "revision": {
            "exec_res": 0,
            "exec_err": "incorrect answer",
            "Question": "How many active and closed District Community Day Schools are there in the county of Alpine?",
            "Evidence": "",
            "GOLD_SQL": "SELECT COUNT(School) FROM schools WHERE (StatusType = 'Closed' OR StatusType = 'Active') AND SOC = 69 AND County = 'Alpine'",
            "PREDICTED_SQL": "SELECT SUM(CASE WHEN T2.StatusType = 'Active' THEN 1 ELSE 0 END) AS num1 , SUM(CASE WHEN T2.StatusType = 'Closed' THEN 1 ELSE 0 END) AS num2 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Alpine' AND T1.`Educational Option Type` = 'Community Day School' AND T2.`School` = 'Community Day School' AND (T2.StatusType = 'Active' OR T2.StatusType = 'Closed')"
        },
        "status": "success"
    }
]